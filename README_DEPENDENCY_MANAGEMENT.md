# ðŸ“¦ Dependency Management Guide

This project uses **pip-tools** to ensure consistent and reproducible dependency installations across different machines and environments.

## ðŸ“‹ Overview

### Files

- **`requirements.in`** - High-level dependencies with minimum version constraints (manually maintained)
- **`requirements.txt`** - Auto-generated locked dependencies with exact versions (generated by pip-tools)
- **`requirements_exported.txt`** - Snapshot of currently installed packages (for reference only)

## ðŸ”§ For Users (Installing Dependencies)

### Standard Installation

To set up your environment with locked dependencies:

```powershell
# 1. Create and activate virtual environment
python -m venv .venv
.\.venv\Scripts\activate

# 2. Install dependencies from locked requirements
pip install -r requirements.txt
```

This ensures you get the exact same versions as everyone else on the team.

## ðŸ› ï¸ For Maintainers (Updating Dependencies)

### Adding a New Dependency

1. **Edit `requirements.in`** - Add the new package with minimum version constraint:
   ```
   new-package>=1.0.0
   ```

2. **Regenerate `requirements.txt`**:
   ```powershell
   pip-compile requirements.in --output-file=requirements.txt --resolver=backtracking
   ```

3. **Install the updated dependencies**:
   ```powershell
   pip install -r requirements.txt
   ```

4. **Commit both files**:
   ```powershell
   git add requirements.in requirements.txt
   git commit -m "Add new-package dependency"
   ```

### Updating Existing Dependencies

To update all dependencies to their latest compatible versions:

```powershell
# 1. Compile with upgrade flag
pip-compile requirements.in --output-file=requirements.txt --resolver=backtracking --upgrade

# 2. Install the updated dependencies
pip install -r requirements.txt

# 3. Test thoroughly before committing
```

To update a specific package only:

```powershell
pip-compile requirements.in --output-file=requirements.txt --resolver=backtracking --upgrade-package package-name
```

### Syncing Your Environment

To ensure your virtual environment exactly matches `requirements.txt`:

```powershell
pip-sync requirements.txt
```

> **Note:** `pip-sync` will uninstall packages not in `requirements.txt` and install/upgrade those that are.

## ðŸ” Troubleshooting

### Dependency Conflicts

If you encounter conflicts during compilation:

1. Review the error message to identify conflicting packages
2. Adjust version constraints in `requirements.in`
3. Recompile with verbose output:
   ```powershell
   pip-compile requirements.in --output-file=requirements.txt --resolver=backtracking --verbose
   ```

### Environment Mismatch

If your environment doesn't match `requirements.txt`:

```powershell
# Option 1: Sync existing environment
pip-sync requirements.txt

# Option 2: Fresh start
deactivate
Remove-Item -Recurse -Force .venv
python -m venv .venv
.\.venv\Scripts\activate
pip install -r requirements.txt
```

## ðŸ“š Best Practices

1. **Always use `requirements.txt` for installation** - This ensures reproducibility
2. **Only edit `requirements.in`** - Never manually edit `requirements.txt`
3. **Recompile after editing `requirements.in`** - Keep both files in sync
4. **Commit both files together** - They should always be updated as a pair
5. **Test thoroughly after updates** - Run your test suite before committing dependency changes
6. **Use version constraints wisely**:
   - Use `>=` for minimum versions: `package>=1.0.0`
   - Use `<` to prevent breaking changes: `package>=1.0.0,<2.0.0`
   - Avoid exact pins in `.in` unless absolutely necessary

## ðŸ”— Resources

- [pip-tools Documentation](https://github.com/jazzband/pip-tools)
- [Python Packaging Best Practices](https://packaging.python.org/guides/tool-recommendations/)
